{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="container mt-5" dir="rtl">
    <h1 class="text-center mb-4 text-primary"><span dir="rtl">قائمة المهام</span> (Liste de Toutes les Missions)</h1>

    <div class="text-start mb-3">
      <a href="{% url 'mission:creer_mission' %}" class="btn btn-success"><i class="fas fa-plus"></i> <span dir="rtl">إضافة مهمة جديدة</span> (Ajouter une Mission)</a>
    </div>

    {% if missions %}
      <div class="table-responsive shadow-lg rounded">
        <table class="table table-striped table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th scope="col" class="text-end">#</th>
              <th scope="col" class="text-end">
                <span dir="rtl">الموظف</span> (Personnel)
              </th>
              <th scope="col" class="text-end">
                <span dir="rtl">الشركة</span> (Entreprise)
              </th>
              <th scope="col" class="text-end">
                <span dir="rtl">تاريخ الإنطلاق</span> (Date Départ)
              </th>
              <th scope="col" class="text-end">
                <span dir="rtl">تاريخ العودة</span> (Date Retour)
              </th>
              <th scope="col" class="text-end">
                <span dir="rtl">الغرض</span> (Objet)
              </th>
              <th scope="col" class="text-center">
                <span dir="rtl">الإجراءات</span> (Actions)
              </th>
            </tr>
          </thead>
          <tbody>
            {% for mission in missions %}
              <tr>
                <th scope="row" class="text-end">{{ forloop.counter }}</th>
                <td class="text-end">
                  <a href="{% url 'personnel:detail_personnel' pk=mission.personnel.pk %}">{{ mission.personnel }}</a>
                </td>
                <td class="text-end">{{ mission.entreprise }}</td>
                <td class="text-end">{{ mission.date_depart|date:'d M Y H:i' }}</td>
                <td class="text-end">{{ mission.date_retour|date:'d M Y H:i' }}</td>
                <td class="text-end">{{ mission.objet|truncatechars:50 }}</td>
                <td class="text-center">
                  <a href="{% url 'mission:modifier_mission' pk=mission.pk %}" class="btn btn-sm btn-primary"><i class="fas fa-edit"></i> <span dir="rtl">تعديل</span> (Modifier)</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="alert alert-info text-center mt-4" role="alert">
        <span dir="rtl">لا توجد مهام مسجلة حاليًا.</span> (Aucune mission enregistrée pour le moment.)
      </div>
    {% endif %}
  </div>
{% endblock %}
